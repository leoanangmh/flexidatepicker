{"version":3,"file":"flexidatepicker.esm.min.js","sources":["../src/flexidatepicker.js"],"sourcesContent":["/**\n * FlexiDatepicker\n * A lightweight, dependency-free JavaScript date picker supporting single, multiple, range, and multi-range selection modes.\n *\n * @version 1.1.0\n * @license MIT\n * @author\n *   Leo Anang Miftahul Huda\n *\n **/\nexport default class FlexiDatepicker {\n    constructor(inputSelector, options = {}) {\n        this.inputElement = document.querySelector(inputSelector)\n        if (!this.inputElement) {\n            console.error(\"FlexiDatepicker: Input element not found.\")\n            return\n        }\n\n        this.options = {\n            mode: \"multi-range\",\n            showClearAll: true,\n            dateFormat: \"MMM d, yyyy\",\n            locale: \"en-US\",\n            selectedDatesDisplaySelector: \"\",\n            showSelectWeekdays: true,\n            showSelectWeekends: true,\n            showSelectAllDays: true,\n            disabledDates: [],\n            disablePast: false,\n            disableFuture: false,\n            minDate: null,\n            maxDate: null,\n            dualCalendar: false,\n            ...options,\n        }\n\n        this.selectedDisplay = this.options.selectedDatesDisplaySelector\n            ? document.querySelector(this.options.selectedDatesDisplaySelector)\n            : null\n\n        this.currentDate = new Date()\n        this.currentDate2 = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 1)\n        this.ranges = []\n        this.selectedDates = []\n        this.currentRangeStart = null\n        this.todayString = new Date().toISOString().split(\"T\")[0]\n\n        this.datepickerElement = this.buildUI()\n        document.body.appendChild(this.datepickerElement)\n\n        this.show = this.show.bind(this)\n        this.handleOutsideClick = this.handleOutsideClick.bind(this)\n\n        this.attachEventListeners()\n        this.renderCalendar()\n    }\n\n    buildUI() {\n        const datepickerEl = document.createElement(\"div\")\n        datepickerEl.className = \"mrdp-container\"\n\n        if (this.options.dualCalendar) {\n            datepickerEl.classList.add(\"mrdp-dual-calendar\")\n        }\n\n        const showMultiControls = this.options.mode === \"multiple\" || this.options.mode === \"multi-range\"\n\n        let selectionControlsHTML = \"\"\n        if (showMultiControls) {\n            const buttons = []\n            if (this.options.showSelectWeekdays) buttons.push('<button id=\"mrdp-select-weekdays\">Select Weekdays</button>')\n            if (this.options.showSelectWeekends) buttons.push('<button id=\"mrdp-select-weekends\">Select Weekends</button>')\n            if (this.options.showSelectAllDays) buttons.push('<button id=\"mrdp-select-all-days\">Select All Days</button>')\n\n            const gridCols = `repeat(${buttons.length}, 1fr)`\n\n            if (buttons.length > 0) {\n                selectionControlsHTML = `\n                  <div class=\"mrdp-controls\" style=\"grid-template-columns: ${gridCols};\">\n                      ${buttons.join(\"\")}\n                  </div>`\n            }\n        }\n\n        let clearButtonHTML = \"\"\n        if (this.options.showClearAll) {\n            clearButtonHTML = `\n              <div class=\"mrdp-controls\">\n                   <button id=\"mrdp-clear-all\" class=\"mrdp-btn-clear\">Clear All Selections</button>\n              </div>`\n        }\n\n        const weekdayFormatter = new Intl.DateTimeFormat(this.options.locale, { weekday: \"short\" })\n        const weekdayHeaders = []\n        const tempDate = new Date(2020, 5, 7)\n        for (let i = 0; i < 7; i++) {\n            const dayName = weekdayFormatter.format(\n                new Date(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate() + i),\n            )\n            weekdayHeaders.push(`<div class=\"mrdp-day-header\">${dayName}</div>`)\n        }\n\n        if (this.options.dualCalendar) {\n            datepickerEl.innerHTML = `\n          <div class=\"mrdp-dual-wrapper\">\n            <div class=\"mrdp-calendar-panel\">\n              <div class=\"mrdp-header\">\n                <button id=\"mrdp-prev-month-btn\" class=\"mrdp-nav-btn\">&lt;</button>\n                <div class=\"mrdp-month-year-display\">\n                  <button id=\"mrdp-month-btn\" class=\"mrdp-month-year-btn\"></button>\n                  <button id=\"mrdp-year-btn\" class=\"mrdp-month-year-btn\"></button>\n                </div>\n                <button class=\"mrdp-nav-btn\" style=\"visibility: hidden;\">&gt;</button>\n              </div>\n              <div id=\"mrdp-month-picker\" class=\"mrdp-picker-overlay\" style=\"display: none;\">\n                <div class=\"mrdp-picker-header\">Select Month</div>\n                <div id=\"mrdp-month-grid\" class=\"mrdp-month-grid\"></div>\n              </div>\n              <div id=\"mrdp-year-picker\" class=\"mrdp-picker-overlay\" style=\"display: none;\">\n                <div class=\"mrdp-picker-header\">\n                  <button id=\"mrdp-year-prev\" class=\"mrdp-year-nav\">&lt;</button>\n                  <span id=\"mrdp-year-range\"></span>\n                  <button id=\"mrdp-year-next\" class=\"mrdp-year-nav\">&gt;</button>\n                </div>\n                <div id=\"mrdp-year-grid\" class=\"mrdp-year-grid\"></div>\n              </div>\n              <div class=\"mrdp-grid\">\n                ${weekdayHeaders.join(\"\")}\n              </div>\n            </div>\n            <div class=\"mrdp-calendar-panel\">\n              <div class=\"mrdp-header\">\n                <button class=\"mrdp-nav-btn\" style=\"visibility: hidden;\">&lt;</button>\n                <div class=\"mrdp-month-year-display\">\n                  <button id=\"mrdp-month-btn-2\" class=\"mrdp-month-year-btn\"></button>\n                  <button id=\"mrdp-year-btn-2\" class=\"mrdp-month-year-btn\"></button>\n                </div>\n                <button id=\"mrdp-next-month-btn\" class=\"mrdp-nav-btn\">&gt;</button>\n              </div>\n              <div id=\"mrdp-month-picker-2\" class=\"mrdp-picker-overlay\" style=\"display: none;\">\n                <div class=\"mrdp-picker-header\">Select Month</div>\n                <div id=\"mrdp-month-grid-2\" class=\"mrdp-month-grid\"></div>\n              </div>\n              <div id=\"mrdp-year-picker-2\" class=\"mrdp-picker-overlay\" style=\"display: none;\">\n                <div class=\"mrdp-picker-header\">\n                  <button id=\"mrdp-year-prev-2\" class=\"mrdp-year-nav\">&lt;</button>\n                  <span id=\"mrdp-year-range-2\"></span>\n                  <button id=\"mrdp-year-next-2\" class=\"mrdp-year-nav\">&gt;</button>\n                </div>\n                <div id=\"mrdp-year-grid-2\" class=\"mrdp-year-grid\"></div>\n              </div>\n              <div class=\"mrdp-grid-2\">\n                ${weekdayHeaders.join(\"\")}\n              </div>\n            </div>\n          </div>\n          ${selectionControlsHTML}\n          ${clearButtonHTML}\n        `\n        } else {\n            datepickerEl.innerHTML = `\n          <div class=\"mrdp-header\">\n            <button id=\"mrdp-prev-month-btn\" class=\"mrdp-nav-btn\">&lt;</button>\n            <div class=\"mrdp-month-year-display\">\n              <button id=\"mrdp-month-btn\" class=\"mrdp-month-year-btn\"></button>\n              <button id=\"mrdp-year-btn\" class=\"mrdp-month-year-btn\"></button>\n            </div>\n            <button id=\"mrdp-next-month-btn\" class=\"mrdp-nav-btn\">&gt;</button>\n          </div>\n          <div id=\"mrdp-month-picker\" class=\"mrdp-picker-overlay\" style=\"display: none;\">\n            <div class=\"mrdp-picker-header\">Select Month</div>\n            <div id=\"mrdp-month-grid\" class=\"mrdp-month-grid\"></div>\n          </div>\n          <div id=\"mrdp-year-picker\" class=\"mrdp-picker-overlay\" style=\"display: none;\">\n            <div class=\"mrdp-picker-header\">\n              <button id=\"mrdp-year-prev\" class=\"mrdp-year-nav\">&lt;</button>\n              <span id=\"mrdp-year-range\"></span>\n              <button id=\"mrdp-year-next\" class=\"mrdp-year-nav\">&gt;</button>\n            </div>\n            <div id=\"mrdp-year-grid\" class=\"mrdp-year-grid\"></div>\n          </div>\n          <div class=\"mrdp-grid\">\n            ${weekdayHeaders.join(\"\")}\n          </div>\n          ${selectionControlsHTML}\n          ${clearButtonHTML}\n        `\n        }\n\n        this.grid = datepickerEl.querySelector(\".mrdp-grid\")\n        this.monthBtn = datepickerEl.querySelector(\"#mrdp-month-btn\")\n        this.yearBtn = datepickerEl.querySelector(\"#mrdp-year-btn\")\n        this.monthPicker = datepickerEl.querySelector(\"#mrdp-month-picker\")\n        this.yearPicker = datepickerEl.querySelector(\"#mrdp-year-picker\")\n        this.monthGrid = datepickerEl.querySelector(\"#mrdp-month-grid\")\n        this.yearGrid = datepickerEl.querySelector(\"#mrdp-year-grid\")\n        this.yearRange = datepickerEl.querySelector(\"#mrdp-year-range\")\n        this.yearStartOffset = 0\n\n        if (this.options.dualCalendar) {\n            this.grid2 = datepickerEl.querySelector(\".mrdp-grid-2\")\n            this.monthBtn2 = datepickerEl.querySelector(\"#mrdp-month-btn-2\")\n            this.yearBtn2 = datepickerEl.querySelector(\"#mrdp-year-btn-2\")\n            this.monthPicker2 = datepickerEl.querySelector(\"#mrdp-month-picker-2\")\n            this.yearPicker2 = datepickerEl.querySelector(\"#mrdp-year-picker-2\")\n            this.monthGrid2 = datepickerEl.querySelector(\"#mrdp-month-grid-2\")\n            this.yearGrid2 = datepickerEl.querySelector(\"#mrdp-year-grid-2\")\n            this.yearRange2 = datepickerEl.querySelector(\"#mrdp-year-range-2\")\n            this.yearStartOffset2 = 0\n        }\n\n        this.setupMonthYearPickers()\n\n        datepickerEl.querySelector(\"#mrdp-prev-month-btn\").addEventListener(\"click\", () => this.handlePrevMonth())\n        datepickerEl.querySelector(\"#mrdp-next-month-btn\").addEventListener(\"click\", () => this.handleNextMonth())\n\n        if (showMultiControls) {\n            if (this.options.showSelectWeekdays)\n                datepickerEl.querySelector(\"#mrdp-select-weekdays\").addEventListener(\"click\", () => this.handleSelectWeekdays())\n            if (this.options.showSelectWeekends)\n                datepickerEl.querySelector(\"#mrdp-select-weekends\").addEventListener(\"click\", () => this.handleSelectWeekends())\n            if (this.options.showSelectAllDays)\n                datepickerEl.querySelector(\"#mrdp-select-all-days\").addEventListener(\"click\", () => this.handleSelectAllDays())\n        }\n        if (this.options.showClearAll)\n            datepickerEl.querySelector(\"#mrdp-clear-all\").addEventListener(\"click\", () => this.handleClearAll())\n\n        this.monthBtn.addEventListener(\"click\", () => this.showMonthPicker())\n        this.yearBtn.addEventListener(\"click\", () => this.showYearPicker())\n        datepickerEl.querySelector(\"#mrdp-year-prev\").addEventListener(\"click\", () => this.changeYearRange(-12))\n        datepickerEl.querySelector(\"#mrdp-year-next\").addEventListener(\"click\", () => this.changeYearRange(12))\n\n        if (this.options.dualCalendar) {\n            this.monthBtn2.addEventListener(\"click\", () => this.showMonthPicker(2))\n            this.yearBtn2.addEventListener(\"click\", () => this.showYearPicker(2))\n            datepickerEl.querySelector(\"#mrdp-year-prev-2\").addEventListener(\"click\", () => this.changeYearRange(-12, 2))\n            datepickerEl.querySelector(\"#mrdp-year-next-2\").addEventListener(\"click\", () => this.changeYearRange(12, 2))\n        }\n\n        return datepickerEl\n    }\n\n    setupMonthYearPickers() {\n        const monthFormatter = new Intl.DateTimeFormat(this.options.locale, { month: \"short\" })\n\n        this.monthGrid.innerHTML = \"\"\n        for (let i = 0; i < 12; i++) {\n            const monthName = monthFormatter.format(new Date(2020, i, 1))\n            const monthBtn = document.createElement(\"button\")\n            monthBtn.className = \"mrdp-picker-item\"\n            monthBtn.textContent = monthName\n            monthBtn.dataset.month = i\n            monthBtn.addEventListener(\"click\", () => this.selectMonth(i))\n            this.monthGrid.appendChild(monthBtn)\n        }\n\n        if (this.options.dualCalendar) {\n            this.monthGrid2.innerHTML = \"\"\n            for (let i = 0; i < 12; i++) {\n                const monthName = monthFormatter.format(new Date(2020, i, 1))\n                const monthBtn = document.createElement(\"button\")\n                monthBtn.className = \"mrdp-picker-item\"\n                monthBtn.textContent = monthName\n                monthBtn.dataset.month = i\n                monthBtn.addEventListener(\"click\", () => this.selectMonth(i, 2))\n                this.monthGrid2.appendChild(monthBtn)\n            }\n        }\n\n        this.renderYearGrid()\n    }\n\n    renderYearGrid(calendarNum = 1) {\n        const currentYear = new Date().getFullYear()\n        const startYear = currentYear + (calendarNum === 1 ? this.yearStartOffset : this.yearStartOffset2)\n        const yearRange = calendarNum === 1 ? this.yearRange : this.yearRange2\n        const yearGrid = calendarNum === 1 ? this.yearGrid : this.yearGrid2\n\n        yearRange.textContent = `${startYear} - ${startYear + 11}`\n        yearGrid.innerHTML = \"\"\n\n        for (let i = 0; i < 12; i++) {\n            const year = startYear + i\n            const yearBtn = document.createElement(\"button\")\n            yearBtn.className = \"mrdp-picker-item\"\n            yearBtn.textContent = year\n            yearBtn.dataset.year = year\n\n            if (year === currentYear) {\n                yearBtn.classList.add(\"current-year\")\n            }\n\n            yearBtn.addEventListener(\"click\", () => this.selectYear(year, calendarNum))\n            yearGrid.appendChild(yearBtn)\n        }\n    }\n\n    changeYearRange(offset, calendarNum = 1) {\n        if (calendarNum === 1) {\n            this.yearStartOffset += offset\n        } else {\n            this.yearStartOffset2 += offset\n        }\n        this.renderYearGrid(calendarNum)\n    }\n\n    showMonthPicker(calendarNum = 1) {\n        if (calendarNum === 1) {\n            this.monthPicker.style.display = \"block\"\n            this.yearPicker.style.display = \"none\"\n\n            const currentMonth = this.currentDate.getMonth()\n            this.monthGrid.querySelectorAll(\".mrdp-picker-item\").forEach((btn, idx) => {\n                btn.classList.toggle(\"active\", idx === currentMonth)\n            })\n        } else {\n            this.monthPicker2.style.display = \"block\"\n            this.yearPicker2.style.display = \"none\"\n\n            const currentMonth = this.currentDate2.getMonth()\n            this.monthGrid2.querySelectorAll(\".mrdp-picker-item\").forEach((btn, idx) => {\n                btn.classList.toggle(\"active\", idx === currentMonth)\n            })\n        }\n    }\n\n    showYearPicker(calendarNum = 1) {\n        if (calendarNum === 1) {\n            this.yearPicker.style.display = \"block\"\n            this.monthPicker.style.display = \"none\"\n\n            const currentYear = this.currentDate.getFullYear()\n            const baseYear = new Date().getFullYear()\n            this.yearStartOffset = Math.floor((currentYear - baseYear) / 12) * 12\n            this.renderYearGrid(1)\n\n            this.yearGrid.querySelectorAll(\".mrdp-picker-item\").forEach((btn) => {\n                btn.classList.toggle(\"active\", Number.parseInt(btn.dataset.year) === currentYear)\n            })\n        } else {\n            this.yearPicker2.style.display = \"block\"\n            this.monthPicker2.style.display = \"none\"\n\n            const currentYear = this.currentDate2.getFullYear()\n            const baseYear = new Date().getFullYear()\n            this.yearStartOffset2 = Math.floor((currentYear - baseYear) / 12) * 12\n            this.renderYearGrid(2)\n\n            this.yearGrid2.querySelectorAll(\".mrdp-picker-item\").forEach((btn) => {\n                btn.classList.toggle(\"active\", Number.parseInt(btn.dataset.year) === currentYear)\n            })\n        }\n    }\n\n    selectMonth(month, calendarNum = 1) {\n        if (calendarNum === 1) {\n            this.currentDate.setMonth(month)\n            this.monthPicker.style.display = \"none\"\n        } else {\n            this.currentDate2.setMonth(month)\n            this.monthPicker2.style.display = \"none\"\n        }\n        if (this.options.dualCalendar && calendarNum === 1) {\n            this.currentDate2 = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 1)\n        }\n        this.renderCalendar()\n    }\n\n    selectYear(year, calendarNum = 1) {\n        if (calendarNum === 1) {\n            this.currentDate.setFullYear(year)\n            this.yearPicker.style.display = \"none\"\n        } else {\n            this.currentDate2.setFullYear(year)\n            this.yearPicker2.style.display = \"none\"\n        }\n        if (this.options.dualCalendar && calendarNum === 1) {\n            this.currentDate2 = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 1)\n        }\n        this.renderCalendar()\n    }\n\n    show() {\n        if (this.datepickerElement.classList.contains(\"mrdp-visible\")) return\n\n        const rect = this.inputElement.getBoundingClientRect()\n\n        this.datepickerElement.style.top = `${rect.bottom + window.scrollY + 5}px`\n        this.datepickerElement.style.left = `${rect.left + window.scrollX}px`\n\n        this.datepickerElement.classList.add(\"mrdp-visible\")\n    }\n\n    hide() {\n        this.datepickerElement.classList.remove(\"mrdp-visible\")\n    }\n\n    handleOutsideClick(e) {\n        if (e.target === this.inputElement) return\n        if (this.datepickerElement.contains(e.target)) return\n        this.hide()\n    }\n\n    renderCalendar() {\n        this.renderSingleCalendar(this.currentDate, this.grid, this.monthBtn, this.yearBtn)\n\n        if (this.options.dualCalendar) {\n            this.renderSingleCalendar(this.currentDate2, this.grid2, this.monthBtn2, this.yearBtn2)\n        }\n    }\n\n    renderSingleCalendar(date, grid, monthBtn, yearBtn) {\n        const year = date.getFullYear()\n        const month = date.getMonth()\n\n        const dayHeaders = Array.from(grid.querySelectorAll(\".mrdp-day-header\"))\n\n        const dateCells = Array.from(grid.querySelectorAll(\".mrdp-day-cell\"))\n        dateCells.forEach((cell) => cell.remove())\n\n        const monthFormatter = new Intl.DateTimeFormat(this.options.locale, { month: \"long\" })\n        monthBtn.textContent = monthFormatter.format(date)\n        yearBtn.textContent = year\n\n        const firstDayOfMonth = new Date(year, month, 1).getDay()\n        const daysInMonth = new Date(year, month + 1, 0).getDate()\n\n        for (let i = 0; i < firstDayOfMonth; i++) {\n            const emptyCell = document.createElement(\"div\")\n            emptyCell.classList.add(\"mrdp-day-cell\", \"empty\")\n            grid.appendChild(emptyCell)\n        }\n\n        for (let day = 1; day <= daysInMonth; day++) {\n            const cellDate = new Date(year, month, day)\n            const dateString = this._getDateString(year, month, day)\n            const dayCell = document.createElement(\"div\")\n            dayCell.classList.add(\"mrdp-day-cell\")\n            dayCell.textContent = day\n            dayCell.dataset.date = dateString\n\n            const disabled = this.isDateDisabled(cellDate)\n            if (disabled) dayCell.classList.add(\"disabled\")\n\n            if (dateString === this.todayString) dayCell.classList.add(\"today\")\n\n            this._applySelectionStyles(dayCell, dateString)\n\n            if (!disabled) {\n                dayCell.addEventListener(\"click\", () => this.handleDateClick(dateString))\n            }\n\n            grid.appendChild(dayCell)\n        }\n    }\n\n    _applySelectionStyles(dayCell, dateString) {\n        if (this.options.mode === \"single\" || this.options.mode === \"multiple\") {\n            if (this.selectedDates.includes(dateString)) {\n                dayCell.classList.add(\"selected-start\", \"selected-end\") // Use range style for single day\n            }\n            return\n        }\n\n        let isStart = false,\n            isEnd = false,\n            inRange = false\n        for (const range of this.ranges) {\n            if (dateString === range.start) isStart = true\n            if (dateString === range.end) isEnd = true\n            if (dateString > range.start && dateString < range.end) inRange = true\n            if (dateString === range.start && dateString === range.end) isStart = isEnd = true\n        }\n\n        if (isStart && isEnd) dayCell.classList.add(\"selected-start\", \"selected-end\")\n        else if (isStart) dayCell.classList.add(\"selected-start\")\n        else if (isEnd) dayCell.classList.add(\"selected-end\")\n        else if (inRange) dayCell.classList.add(\"in-range\")\n\n        if (dateString === this.currentRangeStart) {\n            dayCell.classList.add(\"pending-start\")\n        }\n    }\n\n    handleDateClick(dateString) {\n        switch (this.options.mode) {\n            case \"single\":\n                this._handleSingleClick(dateString)\n                break\n            case \"multiple\":\n                this._handleMultipleClick(dateString)\n                break\n            case \"range\":\n                this._handleRangeClick(dateString)\n                break\n            case \"multi-range\":\n                this._handleFlexiClick(dateString)\n                break\n        }\n\n        this.renderCalendar()\n        this.updateSelectedDisplay()\n    }\n\n    _handleSingleClick(dateString) {\n        this.selectedDates = [dateString]\n        this.hide()\n    }\n\n    _handleMultipleClick(dateString) {\n        const index = this.selectedDates.indexOf(dateString)\n        if (index > -1) {\n            this.selectedDates.splice(index, 1)\n        } else {\n            this.selectedDates.push(dateString)\n        }\n    }\n\n    _handleRangeClick(dateString) {\n        if (this.currentRangeStart === null) {\n            this.currentRangeStart = dateString\n            this.ranges = []\n        } else {\n            let startDate = this.currentRangeStart,\n                endDate = dateString\n            this.currentRangeStart = null\n            if (endDate < startDate) [startDate, endDate] = [endDate, startDate]\n\n            this.ranges = [{ start: startDate, end: endDate }]\n        }\n    }\n\n    _handleFlexiClick(dateString) {\n        const clickedRangeIndex = this.ranges.findIndex((range) => dateString >= range.start && dateString <= range.end)\n\n        if (clickedRangeIndex > -1) {\n            const clickedRange = this.ranges[clickedRangeIndex]\n            this.ranges.splice(clickedRangeIndex, 1)\n\n            const beforeDate = this.addDay(dateString, -1)\n            const afterDate = this.addDay(dateString, 1)\n\n            if (clickedRange.start === dateString) {\n                if (afterDate <= clickedRange.end) this.ranges.push({ start: afterDate, end: clickedRange.end })\n            } else if (clickedRange.end === dateString) {\n                if (beforeDate >= clickedRange.start) this.ranges.push({ start: clickedRange.start, end: beforeDate })\n            } else {\n                if (beforeDate >= clickedRange.start) this.ranges.push({ start: clickedRange.start, end: beforeDate })\n                if (afterDate <= clickedRange.end) this.ranges.push({ start: afterDate, end: clickedRange.end })\n            }\n            this.currentRangeStart = null\n        } else if (this.currentRangeStart === null) {\n            this.currentRangeStart = dateString\n        } else {\n            let startDate = this.currentRangeStart,\n                endDate = dateString\n            this.currentRangeStart = null\n            if (endDate < startDate) [startDate, endDate] = [endDate, startDate]\n\n            this.ranges.push({ start: startDate, end: endDate })\n            this.simplifyRanges()\n        }\n    }\n\n    handlePrevMonth() {\n        let newMonth = this.currentDate.getMonth() - 1\n        let newYear = this.currentDate.getFullYear()\n        if (newMonth < 0) {\n            newMonth = 11\n            newYear -= 1\n        }\n        this.currentDate = new Date(newYear, newMonth, 1)\n\n        if (this.options.dualCalendar) {\n            this.currentDate2 = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 1)\n        }\n\n        this.renderCalendar()\n    }\n\n    handleNextMonth() {\n        let newMonth = this.currentDate.getMonth() + 1\n        let newYear = this.currentDate.getFullYear()\n        if (newMonth > 11) {\n            newMonth = 0\n            newYear += 1\n        }\n        this.currentDate = new Date(newYear, newMonth, 1)\n\n        if (this.options.dualCalendar) {\n            this.currentDate2 = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 1)\n        }\n\n        this.renderCalendar()\n    }\n\n    handleSelectAllDays() {\n        const year = this.currentDate.getFullYear()\n        const month = this.currentDate.getMonth()\n        const daysInMonth = new Date(year, month + 1, 0).getDate()\n\n        if (this.options.mode === \"multiple\") {\n            for (let day = 1; day <= daysInMonth; day++) {\n                const dateString = this._getDateString(year, month, day)\n                if (!this.selectedDates.includes(dateString)) {\n                    this.selectedDates.push(dateString)\n                }\n            }\n        } else if (this.options.mode === \"multi-range\") {\n            const firstDayString = this._getDateString(year, month, 1)\n            const lastDayString = this._getDateString(year, month, daysInMonth)\n            this.addRanges([{ start: firstDayString, end: lastDayString }])\n        }\n\n        if (this.options.dualCalendar) {\n            const year = this.currentDate2.getFullYear()\n            const month = this.currentDate2.getMonth()\n            const daysInMonth = new Date(year, month + 1, 0).getDate()\n\n            if (this.options.mode === \"multiple\") {\n                for (let day = 1; day <= daysInMonth; day++) {\n                    const dateString = this._getDateString(year, month, day)\n                    if (!this.selectedDates.includes(dateString)) {\n                        this.selectedDates.push(dateString)\n                    }\n                }\n            } else if (this.options.mode === \"multi-range\") {\n                const firstDayString = this._getDateString(year, month, 1)\n                const lastDayString = this._getDateString(year, month, daysInMonth)\n                this.addRanges([{ start: firstDayString, end: lastDayString }])\n            }\n        }\n\n        this.renderCalendar()\n        this.updateSelectedDisplay()\n    }\n\n    handleSelectWeekdays() {\n        const year = this.currentDate.getFullYear()\n        const month = this.currentDate.getMonth()\n        const daysInMonth = new Date(year, month + 1, 0).getDate()\n\n        const newRanges = []\n        const newDates = []\n\n        for (let day = 1; day <= daysInMonth; day++) {\n            const date = new Date(year, month, day)\n            const dayOfWeek = date.getDay()\n            const dateString = this._getDateString(year, month, day)\n\n            const isWeekday = dayOfWeek >= 1 && dayOfWeek <= 5\n\n            if (isWeekday) {\n                if (this.options.mode === \"multiple\" && !this.selectedDates.includes(dateString)) {\n                    newDates.push(dateString)\n                } else if (this.options.mode === \"multi-range\" && !this.isDateInRange(dateString)) {\n                    newRanges.push({ start: dateString, end: dateString })\n                }\n            }\n        }\n\n        if (this.options.dualCalendar) {\n            const year = this.currentDate2.getFullYear()\n            const month = this.currentDate2.getMonth()\n            const daysInMonth = new Date(year, month + 1, 0).getDate()\n\n            for (let day = 1; day <= daysInMonth; day++) {\n                const date = new Date(year, month, day)\n                const dayOfWeek = date.getDay()\n                const dateString = this._getDateString(year, month, day)\n\n                const isWeekday = dayOfWeek >= 1 && dayOfWeek <= 5\n\n                if (isWeekday) {\n                    if (this.options.mode === \"multiple\" && !this.selectedDates.includes(dateString)) {\n                        newDates.push(dateString)\n                    } else if (this.options.mode === \"multi-range\" && !this.isDateInRange(dateString)) {\n                        newRanges.push({ start: dateString, end: dateString })\n                    }\n                }\n            }\n        }\n\n        if (this.options.mode === \"multiple\") this.selectedDates.push(...newDates)\n        if (this.options.mode === \"multi-range\") this.addRanges(newRanges)\n\n        this.renderCalendar()\n        this.updateSelectedDisplay()\n    }\n\n    handleSelectWeekends() {\n        const year = this.currentDate.getFullYear()\n        const month = this.currentDate.getMonth()\n        const daysInMonth = new Date(year, month + 1, 0).getDate()\n\n        const newRanges = []\n        const newDates = []\n\n        for (let day = 1; day <= daysInMonth; day++) {\n            const date = new Date(year, month, day)\n            const dayOfWeek = date.getDay()\n            const dateString = this._getDateString(year, month, day)\n\n            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6\n\n            if (isWeekend) {\n                if (this.options.mode === \"multiple\" && !this.selectedDates.includes(dateString)) {\n                    newDates.push(dateString)\n                } else if (this.options.mode === \"multi-range\" && !this.isDateInRange(dateString)) {\n                    newRanges.push({ start: dateString, end: dateString })\n                }\n            }\n        }\n        if (this.options.dualCalendar) {\n            const year = this.currentDate2.getFullYear()\n            const month = this.currentDate2.getMonth()\n            const daysInMonth = new Date(year, month + 1, 0).getDate()\n\n            for (let day = 1; day <= daysInMonth; day++) {\n                const date = new Date(year, month, day)\n                const dayOfWeek = date.getDay()\n                const dateString = this._getDateString(year, month, day)\n\n                const isWeekend = dayOfWeek === 0 || dayOfWeek === 6\n\n                if (isWeekend) {\n                    if (this.options.mode === \"multiple\" && !this.selectedDates.includes(dateString)) {\n                        newDates.push(dateString)\n                    } else if (this.options.mode === \"multi-range\" && !this.isDateInRange(dateString)) {\n                        newRanges.push({ start: dateString, end: dateString })\n                    }\n                }\n            }\n        }\n\n        if (this.options.mode === \"multiple\") this.selectedDates.push(...newDates)\n        if (this.options.mode === \"multi-range\") this.addRanges(newRanges)\n\n        this.renderCalendar()\n        this.updateSelectedDisplay()\n    }\n\n    handleClearAll() {\n        this.ranges = []\n        this.selectedDates = []\n        this.currentRangeStart = null\n        this.renderCalendar()\n        this.updateSelectedDisplay()\n    }\n\n    updateSelectedDisplay() {\n        this._updateInputValue()\n\n        if (this.selectedDisplay) {\n            this._updateExternalDisplay()\n        }\n\n        if (this.options.onSelectionChange && typeof this.options.onSelectionChange === \"function\") {\n            this.options.onSelectionChange({\n                ranges: this.ranges,\n                dates: this.selectedDates,\n            })\n        }\n    }\n\n    _updateInputValue() {\n        if (this.options.mode === \"single\") {\n            if (this.selectedDates.length === 0) {\n                this.inputElement.value = \"\"\n            } else {\n                this.inputElement.value = this.formatDate(this.selectedDates[0])\n            }\n        } else if (this.options.mode === \"multiple\") {\n            if (this.selectedDates.length === 0) {\n                this.inputElement.value = \"\"\n            } else if (this.selectedDates.length === 1) {\n                this.inputElement.value = this.formatDate(this.selectedDates[0])\n            } else {\n                this.inputElement.value = `${this.selectedDates.length} Dates Selected`\n            }\n        } else if (this.options.mode === \"range\") {\n            if (this.ranges.length === 0) {\n                this.inputElement.value = \"\"\n            } else {\n                const range = this.ranges[0]\n                const start = this.formatDate(range.start)\n                const end = this.formatDate(range.end)\n                this.inputElement.value = start === end ? start : `${start} - ${end}`\n            }\n        } else if (this.options.mode === \"multi-range\") {\n            if (this.ranges.length === 0) {\n                this.inputElement.value = \"\"\n            } else if (this.ranges.length === 1) {\n                const range = this.ranges[0]\n                const start = this.formatDate(range.start)\n                const end = this.formatDate(range.end)\n                this.inputElement.value = start === end ? start : `${start} - ${end}`\n            } else {\n                this.inputElement.value = `${this.ranges.length} Ranges Selected`\n            }\n        }\n    }\n\n    _updateExternalDisplay() {\n        let html = \"\"\n\n        this.selectedDates.sort()\n        this.ranges.sort((a, b) => a.start.localeCompare(b.start))\n\n        if (this.selectedDates.length === 0 && this.ranges.length === 0 && !this.currentRangeStart) {\n            this.selectedDisplay.innerHTML = \"None\"\n            return\n        }\n\n        this.selectedDates.forEach((dateStr) => {\n            html += `<div>${this.formatDate(dateStr, true)}</div>`\n        })\n\n        this.ranges.forEach((range) => {\n            const start = this.formatDate(range.start, true)\n            const end = this.formatDate(range.end, true)\n            if (start === end) html += `<div>${start}</div>`\n            else html += `<div>${start} &mdash; ${end}</div>`\n        })\n\n        if (this.currentRangeStart) {\n            const start = this.formatDate(this.currentRangeStart, true)\n            html += `<div><em>Selecting range from: ${start}...</em></div>`\n        }\n\n        this.selectedDisplay.innerHTML = html\n    }\n\n    formatDate(dateString, showYear = false) {\n        const date = new Date(dateString + \"T00:00:00\")\n        const fmt = this.options.dateFormat || \"MMM d, yyyy\"\n        return this.formatCustomDate(date, fmt)\n    }\n\n    formatCustomDate(date, format) {\n        const day = date.getDate()\n        const month = date.getMonth() + 1\n        const year = date.getFullYear()\n\n        const pad = (n) => n.toString().padStart(2, \"0\")\n\n        const locale = this.options.locale || \"en-US\"\n        const monthNameShort = new Intl.DateTimeFormat(locale, { month: \"short\" }).format(date)\n        const monthNameLong = new Intl.DateTimeFormat(locale, { month: \"long\" }).format(date)\n\n        return format\n            .replace(/dd/g, pad(day))\n            .replace(/d(?![a-z])/g, day)\n            .replace(/MMMM/g, monthNameLong)\n            .replace(/MMM/g, monthNameShort)\n            .replace(/MM/g, pad(month))\n            .replace(/M(?![a-z])/g, month)\n            .replace(/yyyy/g, year)\n            .replace(/yy/g, String(year).slice(-2))\n    }\n\n    addDay(dateString, days) {\n        const date = new Date(dateString + \"T00:00:00\")\n        date.setDate(date.getDate() + days)\n        return this._getDateString(date.getFullYear(), date.getMonth(), date.getDate())\n    }\n\n    _getDateString(year, month, day) {\n        return `${year}-${String(month + 1).padStart(2, \"0\")}-${String(day).padStart(2, \"0\")}`\n    }\n\n    isDateInRange(dateString) {\n        return this.ranges.some((range) => dateString >= range.start && dateString <= range.end)\n    }\n\n    isDateDisabled(date) {\n        const d = date.toISOString().split(\"T\")[0]\n\n        if (this.options.disabledDates.some((dis) => dis === d)) {\n            return true\n        }\n\n        for (const item of this.options.disabledDates) {\n            if (item && item.from && item.to) {\n                if (d >= item.from && d <= item.to) return true\n            }\n        }\n\n        const today = new Date()\n        today.setHours(0, 0, 0, 0)\n        if (this.options.disablePast && date < today) return true\n        if (this.options.disableFuture && date > today) return true\n\n        if (this.options.minDate && d < this.options.minDate) return true\n        if (this.options.maxDate && d > this.options.maxDate) return true\n\n        return false\n    }\n\n    simplifyRanges() {\n        if (this.ranges.length < 2) return\n        this.ranges.sort((a, b) => a.start.localeCompare(b.start))\n\n        const simplified = [this.ranges[0]]\n        for (let i = 1; i < this.ranges.length; i++) {\n            const current = this.ranges[i]\n            const last = simplified[simplified.length - 1]\n            const adjacentDate = this.addDay(last.end, 1)\n\n            if (current.start <= last.end || current.start === adjacentDate) {\n                last.end = current.end > last.end ? current.end : last.end\n            } else {\n                simplified.push(current)\n            }\n        }\n        this.ranges = simplified\n    }\n\n\n    addRanges(newRanges) {\n        for (const newRange of newRanges) {\n            const isContained = this.ranges.some((r) => newRange.start >= r.start && newRange.end <= r.end)\n            if (!isContained) {\n                this.ranges.push(newRange)\n            }\n        }\n        this.simplifyRanges()\n    }\n\n    attachEventListeners() {\n        this.inputElement.addEventListener(\"click\", this.show)\n        document.addEventListener('mousedown', this.handleOutsideClick);\n    }\n}"],"names":["FlexiDatepicker","_createClass","inputSelector","options","arguments","length","undefined","_classCallCheck","this","inputElement","document","querySelector","_objectSpread","mode","showClearAll","dateFormat","locale","selectedDatesDisplaySelector","showSelectWeekdays","showSelectWeekends","showSelectAllDays","disabledDates","disablePast","disableFuture","minDate","maxDate","dualCalendar","selectedDisplay","currentDate","Date","currentDate2","getFullYear","getMonth","ranges","selectedDates","currentRangeStart","todayString","toISOString","split","datepickerElement","buildUI","body","appendChild","show","bind","handleOutsideClick","attachEventListeners","renderCalendar","console","error","key","value","_this","datepickerEl","createElement","className","classList","add","showMultiControls","selectionControlsHTML","buttons","push","gridCols","concat","join","clearButtonHTML","weekdayFormatter","Intl","DateTimeFormat","weekday","weekdayHeaders","tempDate","i","dayName","format","getDate","innerHTML","grid","monthBtn","yearBtn","monthPicker","yearPicker","monthGrid","yearGrid","yearRange","yearStartOffset","grid2","monthBtn2","yearBtn2","monthPicker2","yearPicker2","monthGrid2","yearGrid2","yearRange2","yearStartOffset2","setupMonthYearPickers","addEventListener","handlePrevMonth","handleNextMonth","handleSelectWeekdays","handleSelectWeekends","handleSelectAllDays","handleClearAll","showMonthPicker","showYearPicker","changeYearRange","_this2","monthFormatter","month","_loop","monthName","textContent","dataset","selectMonth","_loop2","_i","renderYearGrid","_this3","calendarNum","currentYear","startYear","_loop3","year","selectYear","offset","style","display","currentMonth","querySelectorAll","forEach","btn","idx","toggle","baseYear","Math","floor","Number","parseInt","setMonth","setFullYear","contains","rect","getBoundingClientRect","top","bottom","window","scrollY","left","scrollX","remove","e","target","hide","renderSingleCalendar","date","_this4","Array","from","cell","firstDayOfMonth","getDay","daysInMonth","emptyCell","_loop4","cellDate","day","dateString","_getDateString","dayCell","disabled","isDateDisabled","_applySelectionStyles","handleDateClick","_step","isStart","isEnd","inRange","_iterator","_createForOfIteratorHelper","s","n","done","range","start","end","err","f","includes","_handleSingleClick","_handleMultipleClick","_handleRangeClick","_handleFlexiClick","updateSelectedDisplay","index","indexOf","splice","startDate","endDate","_ref","clickedRangeIndex","findIndex","clickedRange","beforeDate","addDay","afterDate","_ref2","simplifyRanges","newMonth","newYear","firstDayString","lastDayString","addRanges","_this$selectedDates","newRanges","newDates","dayOfWeek","isDateInRange","apply","_this$selectedDates2","_updateInputValue","_updateExternalDisplay","onSelectionChange","dates","formatDate","_this5","html","sort","a","b","localeCompare","dateStr","fmt","formatCustomDate","pad","toString","padStart","monthNameShort","monthNameLong","replace","String","slice","days","setDate","some","d","dis","_step2","_iterator2","item","to","today","setHours","simplified","current","last","adjacentDate","_step3","_this6","_iterator3","_loop5","newRange","r"],"mappings":"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"}